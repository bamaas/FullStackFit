name: Notify Telegram
on: push
jobs:
  telegram:
    runs-on: ubuntu-latest
    steps:
    - name: Wait for build to succeed
      uses: fountainhead/action-wait-for-check@v1.0.0
      id: wait-for-build
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        checkName: "ci/semaphoreci/push: Build"
        ref: github.event.pull_request.head.sha || github.sha
        
    - name: Do something with a passing build
      if: steps.wait-for-build.outputs.conclusion == 'success'
      uses: yanzay/notify-telegram@v0.1.0
      with:
        chat: ${{ secrets.chat }} # user id or channel name secret
        token: ${{ secrets.telegramtoken }} # token secret
        status: ${{ job.status }} # do not modify this line

    - name: Do something with a failing build
      if: steps.wait-for-build.outputs.conclusion == 'failure'
      uses: yanzay/notify-telegram@v0.1.0
      with:
        chat: ${{ secrets.chat }} # user id or channel name secret
        token: ${{ secrets.telegramtoken }} # token secret
        status: ${{ job.status }} # do not modify this line


      # steps:
      #   - uses: yanzay/notify-telegram@v0.1.0
      #     if: always()
      #     with:
      #       chat: ${{ secrets.chat }} # user id or channel name secret
      #       token: ${{ secrets.telegramtoken }} # token secret
      #       status: ${{ job.status }} # do not modify this line