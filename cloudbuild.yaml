# # steps:
# # - name: 'docker/compose:1.15.0'
# #   args: ['-f', 'docker-compose-prod.yml', 'up', '-d']
# #   tags: ['cloud-builders-community']
# # # - name: 'gcr.io/cloud-builders/docker'
# # #   args: ['tag', fit_reverseproxy-prod:latest', 'gcr.io/$PROJECT_ID/$REPO_NAME:$COMMIT_SHA']
# # # Push the container image to Container Registry
# # - name: 'gcr.io/cloud-builders/docker'
# #   args: ['push', 'gcr.io/$PROJECT_ID/fullstackfit_backend:latest']
# #images: ['gcr.io/$PROJECT_ID/fullstackfit_backend:latest', 'gcr.io/$PROJECT_ID/fullstackfit_backend:latest', 'gcr.io/$PROJECT_ID/fullstackfit_reverseproxy:latest']
# # images:
# # - gcr.io/$PROJECT_ID/fullstackfit:latest

# # steps:
# # # Build the container image
# # - name: 'gcr.io/cloud-builders/docker'
# #   args: ['build', '-t', 'gcr.io/[PROJECT_ID]/[IMAGE]', '.']
# # # Push the container image to Container Registry
# # - name: 'gcr.io/cloud-builders/docker'
# #   args: ['push', 'gcr.io/[PROJECT_ID]/[IMAGE]']
# # # Deploy container image to Cloud Run
# # - name: 'gcr.io/cloud-builders/gcloud'
# #   args: ['run', 'deploy', '[SERVICE_NAME]', '--image', 'gcr.io/[PROJECT_ID]/[IMAGE]', '--region', '[REGION]', '--platform', 'managed', '--allow-unauthenticated']
# # images:
# # - gcr.io/[PROJECT_ID]/[IMAGE]


# # https://cloud.google.com/cloud-build/docs/deploying-builds/deploy-cloud-run

# #cloudbuild.yaml
# steps:
# - name: 'docker/compose:1.19.0'
#   args: ['-f', 'docker-compose-prod.yml', 'up', '-d']
# # - name: 'gcr.io/cloud-builders/docker'
# #   args: ['tag', 'fullstackfit:latest', 'gcr.io/$PROJECT_ID/$REPO_NAME:$COMMIT_SHA']
# images: ['gcr.io/united-watch-268115/github.com/bamaas/fullstackfit_backend:latest']

# #https://github.com/GoogleCloudPlatform/cloud-builders/tree/master/docker
# #https://cloud.google.com/cloud-build/docs/view-build-results


# steps:
# # This step runs the unit tests on the app
# - name: 'python:3.7-slim'
#   id: Test
#   entrypoint: /bin/sh
#   args:
#   - -c
#   - 'pip install flask && python test_app.py -v'

# # This step builds the container image.
# - name: 'gcr.io/cloud-builders/docker'
#   id: Build
#   args:
#   - 'build'
#   - '-t'
#   - 'gcr.io/$PROJECT_ID/hello-cloudbuild:$SHORT_SHA'
#   - '.'

# # This step pushes the image to Container Registry
# # The PROJECT_ID and SHORT_SHA variables are automatically
# # replaced by Cloud Build.
# - name: 'gcr.io/cloud-builders/docker'
#   id: Push
#   args:
#   - 'push'
#   - 'gcr.io/$PROJECT_ID/hello-cloudbuild:$SHORT_SHA'
# #https://cloud.google.com/kubernetes-engine/docs/tutorials/gitops-cloud-build

# Basic config: https://cloud.google.com/cloud-build/docs/configuring-builds/create-basic-configuration



steps:
- name: ‘docker/compose:1.23.2’
  args: ['-f', 'docker-compose-prod.yml', 'up', '-d']
- name: 'gcr.io/cloud-builders/docker'
  args: ['tag', 'workspace_app:latest', 'gcr.io/$PROJECT_ID/$REPO_NAME:$COMMIT_SHA']
images: ['gcr.io/$PROJECT_ID/$REPO_NAME:$COMMIT_SHA']